<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>MLmatrixnorm: — MLmatrixnorm • MixMatrix</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="MLmatrixnorm: — MLmatrixnorm" />

<meta property="og:description" content="Maximum likelihood estimation for matrix normal distributions
Maximum likelihood estimates exist for \(N &amp;gt; max(p/q,q/p)+1\) and are
unique for \(N &amp;gt; max(p,q)\). This finds the estimate for the mean and then alternates
between estimates for the \(U\) and \(V\) matrices until convergence.
An AR(1), compound symmetry, or independence restriction can be proposed for either or both
variance matrices. However, if they are inappropriate for the data, they may fail with
a warning." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MixMatrix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/discriminant-analysis.html">Discriminant Analysis for Matrix Variate Distributions</a>
    </li>
    <li>
      <a href="../articles/matrixnormal.html">Matrix Variate Normal Distributions with MixMatrix</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/gzt/MixMatrix">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>MLmatrixnorm:</h1>
    <small class="dont-index">Source: <a href='https://github.com/gzt/MixMatrix/blob/master/R/matrixnorm.R'><code>R/matrixnorm.R</code></a></small>
    <div class="hidden name"><code>MLmatrixnorm.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Maximum likelihood estimation for matrix normal distributions</p>
<p>Maximum likelihood estimates exist for \(N &gt; max(p/q,q/p)+1\) and are
unique for \(N &gt; max(p,q)\). This finds the estimate for the mean and then alternates
between estimates for the \(U\) and \(V\) matrices until convergence.
An AR(1), compound symmetry, or independence restriction can be proposed for either or both
variance matrices. However, if they are inappropriate for the data, they may fail with
a warning.</p>
    
    </div>

    <pre class="usage"><span class='fu'>MLmatrixnorm</span>(<span class='no'>data</span>, <span class='kw'>row.mean</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>col.mean</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>row.variance</span> <span class='kw'>=</span> <span class='st'>"none"</span>, <span class='kw'>col.variance</span> <span class='kw'>=</span> <span class='st'>"none"</span>, <span class='kw'>tol</span> <span class='kw'>=</span> <span class='fl'>10</span> *
  <span class='no'>.Machine</span>$<span class='no'>double.eps</span>^<span class='fl'>0.5</span>, <span class='kw'>max.iter</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='no'>U</span>, <span class='no'>V</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>Either a list of matrices or a 3-D array with matrices in
dimensions 1 and 2, indexed by dimension 3.</p></td>
    </tr>
    <tr>
      <th>row.mean</th>
      <td><p>By default, <code>FALSE</code>. If <code>TRUE</code>, will fit a
common mean within each row. If both this and <code>col.mean</code> are
<code>TRUE</code>, there will be a common mean for the entire matrix.</p></td>
    </tr>
    <tr>
      <th>col.mean</th>
      <td><p>By default, <code>FALSE</code>. If <code>TRUE</code>, will fit a
common mean within each row. If both this and <code>row.mean</code> are
<code>TRUE</code>, there will be a common mean for the entire matrix.</p></td>
    </tr>
    <tr>
      <th>row.variance</th>
      <td><p>Imposes a variance structure on the rows. Either
'none', 'AR(1)', 'CS' for 'compound symmetry', 'Correlation' for a
correlation matrix, or 'Independence' for
independent and identical variance across the rows.
Only positive correlations are allowed for AR(1) and CS.
Note that while maximum likelihood estimators are available (and used) for
the unconstrained variance matrices, <code>optim</code> is used for any
constraints so it may be considerably slower.</p></td>
    </tr>
    <tr>
      <th>col.variance</th>
      <td><p>Imposes a variance structure on the columns.
Either 'none', 'AR(1)', 'CS', 'Correlation', or 'Independence'.
Only positive correlations are allowed for
AR(1) and CS.</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>Convergence criterion. Measured against square deviation
between iterations of the two variance-covariance matrices.</p></td>
    </tr>
    <tr>
      <th>max.iter</th>
      <td><p>Maximum possible iterations of the algorithm.</p></td>
    </tr>
    <tr>
      <th>U</th>
      <td><p>(optional) Can provide a starting point for the U matrix.
By default, an identity matrix.</p></td>
    </tr>
    <tr>
      <th>V</th>
      <td><p>(optional) Can provide a starting point for the V matrix.
By default, an identity matrix.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>(optional) additional arguments can be passed to <code>optim</code>
if using restrictions on the variance.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a list with a mean matrix, a \(U\) matrix, a \(V\)
   matrix, the variance parameter (the first entry of the variance matrices
   are constrained to be 1 for uniqueness), the number of iterations, the squared difference
   between iterations of the variance matrices at the time of stopping, the log likelihood,
   and a convergence code.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='rmatrixnorm.html'>rmatrixnorm</a></code></p>
<p>Other matrixnorm: <code><a href='rmatrixnorm.html'>rmatrixnorm</a></code></p>
<p>Other matrix-variate: <code><a href='MLmatrixt.html'>MLmatrixt</a></code>,
  <code><a href='matrixlda.html'>matrixlda</a></code>, <code><a href='matrixqda.html'>matrixqda</a></code>,
  <code><a href='predict.matrixlda.html'>predict.matrixlda</a></code>,
  <code><a href='rmatrixinvt.html'>rmatrixinvt</a></code>, <code><a href='rmatrixnorm.html'>rmatrixnorm</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>20180202</span>)
<span class='no'>A</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='rmatrixnorm.html'>rmatrixnorm</a></span>(<span class='kw'>n</span><span class='kw'>=</span><span class='fl'>100</span>,<span class='kw'>mean</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>100</span>,<span class='fl'>0</span>,-<span class='fl'>100</span>,<span class='fl'>0</span>,<span class='fl'>25</span>,-<span class='fl'>1000</span>),<span class='kw'>nrow</span><span class='kw'>=</span><span class='fl'>2</span>),
   <span class='kw'>L</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>.1</span>),<span class='kw'>nrow</span><span class='kw'>=</span><span class='fl'>2</span>),<span class='kw'>list</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>results</span><span class='kw'>=</span><span class='fu'>MLmatrixnorm</span>(<span class='no'>A</span>, <span class='kw'>tol</span> <span class='kw'>=</span> <span class='fl'>1e-5</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>results</span>)</div><div class='output co'>#&gt; $mean
#&gt;            [,1]         [,2]      [,3]
#&gt; [1,] 99.7692446 -100.2587675   25.0921
#&gt; [2,] -0.1010964   -0.1537989 -999.9448
#&gt; 
#&gt; $U
#&gt;           [,1]      [,2]
#&gt; [1,] 1.0000000 0.5011833
#&gt; [2,] 0.5011833 0.2542832
#&gt; 
#&gt; $V
#&gt;             [,1]        [,2]         [,3]
#&gt; [1,] 1.000000000  0.08886106  0.003307394
#&gt; [2,] 0.088861062  0.99216709 -0.048960829
#&gt; [3,] 0.003307394 -0.04896083  0.808693751
#&gt; 
#&gt; $var
#&gt; [1] 3.984761
#&gt; 
#&gt; $iter
#&gt; [1] 4
#&gt; 
#&gt; $tol
#&gt; [1] 1.599358e-07
#&gt; 
#&gt; $logLik
#&gt; [1] -376.4574
#&gt; 
#&gt; $convergence
#&gt; [1] TRUE
#&gt; 
#&gt; $call
#&gt; MLmatrixnorm(data = A, tol = 1e-05)
#&gt; </div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Geoffrey Thompson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

