<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ML estimation of the Matrix Variate t Distribution • MixMatrix</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="ML estimation of the Matrix Variate t Distribution">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MixMatrix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/discriminant-analysis.html">Discriminant Analysis for Matrix Variate Distributions</a>
    </li>
    <li>
      <a href="../articles/matrix-t-estimation.html">ML estimation of the Matrix Variate t Distribution</a>
    </li>
    <li>
      <a href="../articles/matrixnormal.html">Matrix Variate Normal Distributions with MixMatrix</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/gzt/MixMatrix">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>ML estimation of the Matrix Variate t Distribution</h1>
                        <h4 class="author">Geoffrey Thompson</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gzt/MixMatrix/blob/master/vignettes/matrix-t-estimation.Rmd"><code>vignettes/matrix-t-estimation.Rmd</code></a></small>
      <div class="hidden name"><code>matrix-t-estimation.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(MixMatrix)</a></code></pre></div>
<div id="estimation-of-the-matrix-variate-t-distribution" class="section level2">
<h2 class="hasAnchor">
<a href="#estimation-of-the-matrix-variate-t-distribution" class="anchor"></a>Estimation of the Matrix Variate <em>t</em> Distribution</h2>
<p>The parameters of the multivariate <em>t</em> distribution can be estimated using the EM algorithm. An EM algorithm for the multivariate <span class="math inline">\(t\)</span>-distribution with no missing data was provided by <span class="citation">Rubin (1983)</span>. This was variously extended and refined, as the EM algorithm can be quite slow to converge. One set of refinements split the M-step into a series of conditional maximization (CM) steps <span class="citation">(Meng and Rubin 1993)</span>, and then a later refinement (called ECME) allowed for either conditional maximization steps or maximizing the constrained actual likelihood <span class="citation">(Liu and Rubin 1994)</span>, which leads to dramatically faster convergence. The matrix variate <span class="math inline">\(t\)</span> is an extension of the multivariate version <span class="citation">(Dickey 1967)</span>, however, unlike the normal distribution, it cannot be treated as a rearrangement of the multivariate case, so the addition of the extra dimension poses a non-trivial problem for extending the results.</p>
<p>An <span class="math inline">\(n \times p\)</span> random matrix <span class="math inline">\(\mathbf{X}\)</span> is distributed as a matrix variate <span class="math inline">\(t\)</span> random variable if it has probability density function as follows: <span class="math display">\[{\frac  {\Gamma _{p}\left({\frac  {\nu +n+p-1}{2}}\right)}{(\pi )^{{\frac  {np}{2}}}\Gamma _{p}\left({\frac  {\nu +p-1}{2}}\right)}}|{\boldsymbol  \Omega }|^{{-{\frac  {n}{2}}}}|{\boldsymbol  \Sigma }|^{{-{\frac  {p}{2}}}}\]</span></p>
<p>With <span class="math inline">\(\Omega\)</span> and <span class="math inline">\(\Sigma\)</span> covariance matrices of appropriate dimension, <span class="math inline">\(\mathbf{M}\)</span> a mean matrix, <span class="math inline">\(\nu\)</span> the degrees of freedom parameter, and <span class="math inline">\(\Gamma_p()\)</span> the multivariate gamma function, which is implemented in the <a href="http://gzt.github.io/CholWishart"><code>CholWishart</code></a> package available on CRAN.</p>
<p>For details of the ECME algorithm used for estimation, there is a forthcoming paper.</p>
</div>
<div id="with-nu-known" class="section level2">
<h2 class="hasAnchor">
<a href="#with-nu-known" class="anchor"></a>With <span class="math inline">\(\nu\)</span> known</h2>
<p>If the degrees of freedom parameter, <span class="math inline">\(\nu\)</span> known, the estimation is fairly straightforward. The procedure is similar to the multivariate <span class="math inline">\(t\)</span> or the matrix variate normal. In this case, the interface is just like the interface for the <code><a href="../reference/MLmatrixnorm.html">MLmatrixnorm()</a></code> function:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">20190622</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">sigma =<span class="st"> </span>(<span class="dv">1</span><span class="op">/</span><span class="dv">7</span>) <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/rWishart">rWishart</a></span>(<span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">1</span><span class="op">*</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/diag">diag</a></span>(<span class="dv">3</span><span class="op">:</span><span class="dv">1</span>))[,,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">A =<span class="st"> </span><span class="kw"><a href="../reference/rmatrixt.html">rmatrixt</a></span>(<span class="dt">n=</span><span class="dv">100</span>,<span class="dt">mean=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="op">-</span><span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">25</span>,<span class="op">-</span><span class="dv">1000</span>),<span class="dt">nrow=</span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">   <span class="dt">V =</span> sigma, <span class="dt">df =</span> <span class="dv">7</span>)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">results=<span class="kw"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span>(A, <span class="dt">df =</span> <span class="dv">7</span>)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(results)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; $mean</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt;            [,1]          [,2]        [,3]</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; [1,] 99.8291911 -1.000708e+02    25.01042</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; [2,] -0.0425028 -8.261356e-03 -1000.02357</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt; $U</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt;             [,1]        [,2]</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt; [1,]  1.00000000 -0.08039981</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt; [2,] -0.08039981  0.97069319</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt; $V</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co">#&gt;           [,1]       [,2]       [,3]</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">#&gt; [1,] 1.0000000 0.21375613 0.11094767</span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co">#&gt; [2,] 0.2137561 0.14872070 0.04098332</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="co">#&gt; [3,] 0.1109477 0.04098332 0.12860660</span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="co">#&gt; $var</span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="co">#&gt; [1] 5.148569</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26"><span class="co">#&gt; $nu</span></a>
<a class="sourceLine" id="cb2-27" data-line-number="27"><span class="co">#&gt; [1] 7</span></a>
<a class="sourceLine" id="cb2-28" data-line-number="28"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-29" data-line-number="29"><span class="co">#&gt; $iter</span></a>
<a class="sourceLine" id="cb2-30" data-line-number="30"><span class="co">#&gt; [1] 44</span></a>
<a class="sourceLine" id="cb2-31" data-line-number="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-32" data-line-number="32"><span class="co">#&gt; $tol</span></a>
<a class="sourceLine" id="cb2-33" data-line-number="33"><span class="co">#&gt; [1] 1.155396e-08</span></a>
<a class="sourceLine" id="cb2-34" data-line-number="34"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-35" data-line-number="35"><span class="co">#&gt; $logLik</span></a>
<a class="sourceLine" id="cb2-36" data-line-number="36"><span class="co">#&gt; [1] -386.7623</span></a>
<a class="sourceLine" id="cb2-37" data-line-number="37"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-38" data-line-number="38"><span class="co">#&gt; $convergence</span></a>
<a class="sourceLine" id="cb2-39" data-line-number="39"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb2-40" data-line-number="40"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-41" data-line-number="41"><span class="co">#&gt; $call</span></a>
<a class="sourceLine" id="cb2-42" data-line-number="42"><span class="co">#&gt; MLmatrixt(data = A, df = 7)</span></a></code></pre></div>
<p>There are two restrictions possible for the mean matrices: <code>row.mean = TRUE</code> will force a common mean within a row and <code>col.mean = TRUE</code> will force a common mean within a column. Setting both will ensure a constant mean for the entire system. Restrictions on <span class="math inline">\(\mathbf{U}\)</span> and <span class="math inline">\(\mathbf{V}\)</span>, the row-wise variance and column-wise variance, are possible with <code>row.variance</code> and <code>col.variance</code> commands.</p>
<p>The options for variance restrictions are the same as for the <code><a href="../reference/MLmatrixnorm.html">MLmatrixnorm()</a></code> function. Currently the options for variance restrictions are to impose an AR(1) structure by providing the <code>AR(1)</code> option, a compound symmetry structure by providing the <code>CS</code> option, to impose a correlation matrix structure by specifying <code>correlation</code> or <code>corr</code>, or to impose an identical and independent structure by specifying <code>Independent</code> or <code>I</code>. This works by using <code>uniroot</code> to find the appropriate <span class="math inline">\(\rho\)</span> which sets the derivative of the log-likelihood to zero for the <code>AR</code> and <code>CS</code> options - it is not fast but if this is the true structure it will be better in some sense than an unstructured variance matrix. The <span class="math inline">\(\rho\)</span> parameter should be <span class="math inline">\(&gt;0\)</span> and is forced to be non-negative. If the data behaves incompatibly with those restrictions, the function will provide a warning and exit with the current model fit.</p>
</div>
<div id="with-nu-unknown" class="section level2">
<h2 class="hasAnchor">
<a href="#with-nu-unknown" class="anchor"></a>With <span class="math inline">\(\nu\)</span> unknown</h2>
<p>Estimation of <span class="math inline">\(\nu\)</span>, the degrees of freedom parameter, is slow and the principal mathematical difficulty of the matrix-variate <span class="math inline">\(t\)</span> distribution. It is performed using ECME. Generally, a fair amount more data are needed in order to have good convergence properties for the estimator, but they have not been derived analytically. Here you can see the recovery of the parameter for a few choices of the parameter and sample sizes. Because of the relative slowness of running a longer simulation, this only includes one set of examples. I give code for a longer and larger simulation that what is plotted if you’re really interested. What is plotted below is only the <code>df = 10</code> example with 75 trials and a maximum number of iterations <code>max.iter = 10</code>. The full simulation may take several minutes.</p>
<pre><code><a href="https://www.rdocumentation.org/packages/base/topics/library">library(ggplot2)
set.seed(20181102)
df = c(5, 10, 20)
df5 &lt;- rep(0,200)
df10 &lt;- rep(0,200)
df100 &lt;- rep(0,200)
df550 &lt;-  rep(0,200)
df1050 &lt;-  rep(0,200)
df2050 &lt;- rep(0,200)
df5100 &lt;-  rep(0,200)
df10100 &lt;-  rep(0,200)
df20100 &lt;- rep(0,200)


for(i in 1:200){
  df5[i] = MLmatrixt(rmatrixt(mean = matrix(0,5,3),df = 5, n = 35, U =diag(5), V =diag(3)), fixed = FALSE, df = 5)$nu
  df10[i] = MLmatrixt(rmatrixt(mean = matrix(0,5,3),df = 10, n = 35, U =diag(5), V =diag(3)), fixed = FALSE, df = 5)$nu
  df100[i] = MLmatrixt(rmatrixt(mean = matrix(0,5,3),df = 20, n = 35, U =diag(5), V =diag(3)), fixed = FALSE, df = 5)$nu
    df550[i] = MLmatrixt(rmatrixt(mean = matrix(0,5,3),df = 5, n = 50, U =diag(5), V =diag(3)), fixed = FALSE, df = 5)$nu
  df1050[i] = MLmatrixt(rmatrixt(mean = matrix(0,5,3),df = 10, n = 50, U =diag(5), V =diag(3)), fixed = FALSE, df = 5)$nu
  df2050[i] = MLmatrixt(rmatrixt(mean = matrix(0,5,3),df = 20, n = 50, U =diag(5), V =diag(3)), fixed = FALSE, df = 5)$nu
    df5100[i] = MLmatrixt(rmatrixt(mean = matrix(0,5,3),df = 5, n = 100, U =diag(5), V =diag(3)), fixed = FALSE, df = 5)$nu
  df10100[i] = MLmatrixt(rmatrixt(mean = matrix(0,5,3),df = 10, n = 100, U =diag(5), V =diag(3)), fixed = FALSE, df = 5)$nu
  df20100[i] = MLmatrixt(rmatrixt(mean = matrix(0,5,3),df = 20, n = 100, U =diag(5), V =diag(3)), fixed = FALSE, df = 5)$nu
}

truedataframe = data.frame(truedf = factor(c(5,10,20), label = c('5 df', '10 df', '20 df')), estdf = c(5,10,20))

dfdataframe = data.frame(truedf = factor(rep(rep(c(5,10,20), each = 200),3), label = c('5 df', '10 df', '20 df')),
                         estdf = c(df5, df10, df100, df550, df1050, df2050, df5100, df10100, df20100),
                         samplesize = factor(rep(c(35,50,100), each = 600)))
library(tidyverse)

denseplot &lt;- ggplot(data = subset(dfdataframe, estdf &lt; 200),aes(x=estdf, fill=samplesize)) +
    #geom_histogram() +
    #geom_freqpoly(fill = samplesize, alpha = .5) +
    geom_density(alpha = .5) +
    geom_vline(data = truedataframe,
               mapping = aes(xintercept = estdf),
               size = .5) +
    theme_bw() +
    theme(axis.ticks.y=element_blank(), axis.text.y=element_blank(), strip.text = element_text(size = 8), 
          legend.justification=c(1,0), legend.position=c(.95,.4),
          legend.background = element_blank(),
          legend.text =element_text(size = 8), legend.title = element_text(size = 8)) +
    ggtitle("Density plot of estimated degrees of freedom compared to actual") +
    xlab(NULL) +
    ylab(NULL) +     
    scale_fill_manual(values = c("#050505", "#E69F00", "#56B4E9"), name = "Sample Size") +
    facet_wrap(factor(truedf)~.,  scales="free") +
    NULL
denseplot


knitr::kable(dfdataframe %&gt;% group_by(truedf, samplesize) %&gt;% 
    summarize(min = min(estdf), max = max(estdf),
    median = median(estdf),
    mean=mean(estdf),
    sd = sd(estdf)))
</a></code></pre>
<pre><code>#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 35, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 50, U =
#&gt; diag(5), : Failed to converge
#&gt; Warning in MLmatrixt(rmatrixt(mean = matrix(0, 5, 3), df = 10, n = 100, :
#&gt; Failed to converge
#&gt; 
#&gt; Attaching package: 'dplyr'
#&gt; The following objects are masked from 'package:stats':
#&gt; 
#&gt;     filter, lag
#&gt; The following objects are masked from 'package:base':
#&gt; 
#&gt;     intersect, setdiff, setequal, union</code></pre>
<p><img src="matrix-t-estimation_files/figure-html/dftenexample-1.png" width="700"></p>
<table class="table">
<thead><tr class="header">
<th align="left">samplesize</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">median</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">35</td>
<td align="right">8.137380</td>
<td align="right">13.48535</td>
<td align="right">10.328672</td>
<td align="right">10.494229</td>
<td align="right">1.3426509</td>
</tr>
<tr class="even">
<td align="left">50</td>
<td align="right">7.143011</td>
<td align="right">12.47284</td>
<td align="right">9.975127</td>
<td align="right">10.017150</td>
<td align="right">1.1420905</td>
</tr>
<tr class="odd">
<td align="left">100</td>
<td align="right">8.650302</td>
<td align="right">11.67719</td>
<td align="right">9.888218</td>
<td align="right">9.906214</td>
<td align="right">0.7178291</td>
</tr>
</tbody>
</table>
<p>As expected, increased sample size leads to better results in recovering the parameter.</p>
</div>
<div id="use-for-classification" class="section level2">
<h2 class="hasAnchor">
<a href="#use-for-classification" class="anchor"></a>Use for classification</h2>
<p>Using the <span class="math inline">\(t\)</span> distribution works in both <code><a href="../reference/matrixlda.html">matrixlda()</a></code> and <code><a href="../reference/matrixqda.html">matrixqda()</a></code> as expected by specifying <code>method = "t"</code> and providing either a single parameter (for <code>lda</code> or <code>qda</code>) for the degrees of freedom or a vector as long as the number of classes (for <code>qda</code>). Additional parameters for fitting can be passed through the <code>...</code> to <code><a href="../reference/MLmatrixt.html">MLmatrixt()</a></code> just as for the normal case, including estimating the degrees of freedom parameter. The <code>qda</code> will only estimate <code>nu</code> with it varying between groups, it will not estimate a common <code>nu</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">A &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rmatrixt.html">rmatrixt</a></span>(<span class="dv">30</span>, <span class="dt">mean =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dv">0</span>, <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">ncol=</span><span class="dv">3</span>), <span class="dt">df =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">B &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rmatrixt.html">rmatrixt</a></span>(<span class="dv">30</span>, <span class="dt">mean =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">ncol=</span><span class="dv">3</span>), <span class="dt">df =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">C &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rmatrixt.html">rmatrixt</a></span>(<span class="dv">30</span>, <span class="dt">mean =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">ncol=</span><span class="dv">3</span>), <span class="dt">df =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">ABC &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/array">array</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(A,B,C), <span class="dt">dim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">90</span>))</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">groups &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"A"</span>,<span class="dv">30</span>),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"B"</span>,<span class="dv">30</span>),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"C"</span>,<span class="dv">30</span>)))</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">prior =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">30</span>,<span class="dv">30</span>,<span class="dv">30</span>)<span class="op">/</span><span class="dv">90</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7">matlda &lt;-<span class="st"> </span><span class="kw"><a href="../reference/matrixlda.html">matrixlda</a></span>(<span class="dt">x =</span> ABC,<span class="dt">grouping =</span> groups, <span class="dt">prior =</span> prior,</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">                    <span class="dt">method =</span> <span class="st">'t'</span>, <span class="dt">nu =</span> <span class="dv">10</span>, <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(matlda, <span class="dt">newdata =</span> ABC[,,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">31</span>,<span class="dv">61</span>)])</a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt; $class</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt; [1] A B A</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt; Levels: A B C</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; $posterior</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt;              [,1]        [,2]         [,3]</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt; [1,] 9.971549e-01 0.002764948 8.019449e-05</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt; [2,] 2.462478e-05 0.999975269 1.058075e-07</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#&gt; [3,] 9.546356e-01 0.003977114 4.138732e-02</span></a></code></pre></div>
</div>
<div id="session-info" class="section level2">
<h2 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session info</h2>
<p>This vignette was built using <code>rmarkdown</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/sessionInfo">sessionInfo</a></span>()</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt; R version 3.6.0 (2017-01-27)</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt; Running under: Ubuntu 14.04.5 LTS</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; Matrix products: default</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; BLAS:   /home/travis/R-bin/lib/R/lib/libRblas.so</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; LAPACK: /home/travis/R-bin/lib/R/lib/libRlapack.so</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; locale:</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co">#&gt; attached base packages:</span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="co">#&gt; other attached packages:</span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="co">#&gt; [1] magrittr_1.5    dplyr_0.8.1     ggplot2_3.2.0   MixMatrix_0.1.0</span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="co">#&gt; loaded via a namespace (and not attached):</span></a>
<a class="sourceLine" id="cb6-25" data-line-number="25"><span class="co">#&gt;  [1] Rcpp_1.0.1        highr_0.8         compiler_3.6.0   </span></a>
<a class="sourceLine" id="cb6-26" data-line-number="26"><span class="co">#&gt;  [4] pillar_1.4.1      tools_3.6.0       digest_0.6.19    </span></a>
<a class="sourceLine" id="cb6-27" data-line-number="27"><span class="co">#&gt;  [7] evaluate_0.14     memoise_1.1.0     tibble_2.1.3     </span></a>
<a class="sourceLine" id="cb6-28" data-line-number="28"><span class="co">#&gt; [10] gtable_0.3.0      pkgconfig_2.0.2   rlang_0.3.4      </span></a>
<a class="sourceLine" id="cb6-29" data-line-number="29"><span class="co">#&gt; [13] commonmark_1.7    yaml_2.2.0        pkgdown_1.3.0    </span></a>
<a class="sourceLine" id="cb6-30" data-line-number="30"><span class="co">#&gt; [16] xfun_0.7          withr_2.1.2       stringr_1.4.0    </span></a>
<a class="sourceLine" id="cb6-31" data-line-number="31"><span class="co">#&gt; [19] roxygen2_6.1.1    xml2_1.2.0        knitr_1.23       </span></a>
<a class="sourceLine" id="cb6-32" data-line-number="32"><span class="co">#&gt; [22] desc_1.2.0        fs_1.3.1          rprojroot_1.3-2  </span></a>
<a class="sourceLine" id="cb6-33" data-line-number="33"><span class="co">#&gt; [25] grid_3.6.0        tidyselect_0.2.5  glue_1.3.1       </span></a>
<a class="sourceLine" id="cb6-34" data-line-number="34"><span class="co">#&gt; [28] R6_2.4.0          rmarkdown_1.13    purrr_0.3.2      </span></a>
<a class="sourceLine" id="cb6-35" data-line-number="35"><span class="co">#&gt; [31] backports_1.1.4   scales_1.0.0      codetools_0.2-16 </span></a>
<a class="sourceLine" id="cb6-36" data-line-number="36"><span class="co">#&gt; [34] htmltools_0.3.6   MASS_7.3-51.4     assertthat_0.2.1 </span></a>
<a class="sourceLine" id="cb6-37" data-line-number="37"><span class="co">#&gt; [37] CholWishart_1.0.1 colorspace_1.4-1  labeling_0.3     </span></a>
<a class="sourceLine" id="cb6-38" data-line-number="38"><span class="co">#&gt; [40] stringi_1.4.3     lazyeval_0.2.2    munsell_0.5.0    </span></a>
<a class="sourceLine" id="cb6-39" data-line-number="39"><span class="co">#&gt; [43] crayon_1.3.4</span></a></code></pre></div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-dickey1967">
<p>Dickey, James M. 1967. “Matricvariate Generalizations of the Multivariate <span class="math inline">\(t\)</span> Distribution and the Inverted Multivariate <span class="math inline">\(t\)</span> Distribution.” <em>Ann. Math. Statist.</em> 38 (2). The Institute of Mathematical Statistics: 511–18. <a href="https://doi.org/10.1214/aoms/1177698967" class="uri">https://doi.org/10.1214/aoms/1177698967</a>.</p>
</div>
<div id="ref-liurubin1994">
<p>Liu, Chuanhai, and Donald B. Rubin. 1994. “The ECME Algorithm: A Simple Extension of EM and ECM with Faster Monotone Convergence.” <em>Biometrika</em> 81 (4). [Oxford University Press, Biometrika Trust]: 633–48. <a href="http://www.jstor.org/stable/2337067" class="uri">http://www.jstor.org/stable/2337067</a>.</p>
</div>
<div id="ref-meng1993">
<p>Meng, Xiao-Li, and Donald B. Rubin. 1993. “Maximum Likelihood Estimation via the ECM Algorithm: A General Framework.” <em>Biometrika</em> 80 (2): 267–78. <a href="https://doi.org/10.1093/biomet/80.2.267" class="uri">https://doi.org/10.1093/biomet/80.2.267</a>.</p>
</div>
<div id="ref-rubin1983">
<p>Rubin, D.B. 1983. “Encyclopedia of Statistical Sciences.” In, 4th ed., 272–5. John Wiley.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#estimation-of-the-matrix-variate-t-distribution">Estimation of the Matrix Variate <em>t</em> Distribution</a></li>
      <li><a href="#with-nu-known">With <span class="math inline">\(\nu\)</span> known</a></li>
      <li><a href="#with-nu-unknown">With <span class="math inline">\(\nu\)</span> unknown</a></li>
      <li><a href="#use-for-classification">Use for classification</a></li>
      <li><a href="#session-info">Session info</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Geoffrey Thompson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
