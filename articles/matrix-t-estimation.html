<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ML estimation of the Matrix Variate t Distribution • MixMatrix</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="ML estimation of the Matrix Variate t Distribution">
<meta property="og:description" content="MixMatrix">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MixMatrix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/discriminant-analysis.html">Discriminant Analysis for Matrix Variate Distributions</a>
    </li>
    <li>
      <a href="../articles/matrix-t-estimation.html">ML estimation of the Matrix Variate t Distribution</a>
    </li>
    <li>
      <a href="../articles/matrixnormal.html">Matrix Variate Normal Distributions with MixMatrix</a>
    </li>
    <li>
      <a href="../articles/mixturemodel.html">Matrix Variate Mixture Models with the t distribution</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/gzt/MixMatrix/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>ML estimation of the Matrix Variate t Distribution</h1>
                        <h4 class="author">Geoffrey Thompson</h4>
            
            <h4 class="date">2020-04-02</h4>
      
      <small class="dont-index">Source: <a href="http://github.com/gzt/MixMatrix/blob/master/vignettes/matrix-t-estimation.Rmd"><code>vignettes/matrix-t-estimation.Rmd</code></a></small>
      <div class="hidden name"><code>matrix-t-estimation.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">MixMatrix</span>)</pre></body></html></div>
<div id="estimation-of-the-matrix-variate-t-distribution" class="section level2">
<h2 class="hasAnchor">
<a href="#estimation-of-the-matrix-variate-t-distribution" class="anchor"></a>Estimation of the Matrix Variate <em>t</em> Distribution</h2>
<p>The parameters of the multivariate <em>t</em> distribution can be estimated using the EM algorithm. An EM algorithm for the multivariate <span class="math inline">\(t\)</span>-distribution with no missing data was provided by <span class="citation">Rubin (<a href="#ref-rubin1983" role="doc-biblioref">1983</a>)</span>. This was variously extended and refined, as the EM algorithm can be quite slow to converge. One set of refinements split the M-step into a series of conditional maximization (CM) steps <span class="citation">(Meng and Rubin <a href="#ref-meng1993" role="doc-biblioref">1993</a>)</span>, and then a later refinement (called ECME - Expectation/Conditional Maximization Either) allowed for <em>either</em> conditional maximization steps or maximizing the constrained actual likelihood <span class="citation">(Liu and Rubin <a href="#ref-liurubin1994" role="doc-biblioref">1994</a>)</span>, which leads to dramatically faster convergence. The matrix variate <span class="math inline">\(t\)</span> is an extension of the multivariate version <span class="citation">(Dickey <a href="#ref-dickey1967" role="doc-biblioref">1967</a>)</span>; however, unlike the normal distribution, it cannot be treated as a rearrangement of the multivariate case, so the addition of the extra dimension poses a non-trivial problem for extending the results.</p>
<p>An <span class="math inline">\(n \times p\)</span> random matrix <span class="math inline">\(\mathbf{X}\)</span> is distributed as a matrix variate <span class="math inline">\(t\)</span> random variable if it has probability density function as follows: <span class="math display">\[f({\mathbf  {X}};\nu,{\mathbf  {M}}, {\boldsymbol  \Omega }, {\boldsymbol  \Sigma }) =  {\frac  {\Gamma _{p}\left({\frac  {\nu +n+p-1}{2}}\right)}{(\pi )^{{\frac  {np}{2}}}\Gamma _{p}\left({\frac  {\nu +p-1}{2}}\right)}}|{\boldsymbol  \Omega }|^{{-{\frac  {n}{2}}}}|{\boldsymbol  \Sigma }|^{{-{\frac  {p}{2}}}}\times \left|{\mathbf  {I}}_{n}+{\boldsymbol  \Sigma }^{{-1}}({\mathbf  {X}}-{\mathbf  {M}}){\boldsymbol  \Omega }^{{-1}}({\mathbf  {X}}-{\mathbf  {M}})^{{{\rm {T}}}}\right|^{{-{\frac  {\nu +n+p-1}{2}}}}\]</span></p>
<p>With <span class="math inline">\(\Omega\)</span> and <span class="math inline">\(\Sigma\)</span> covariance matrices of appropriate dimension, <span class="math inline">\(\mathbf{M}\)</span> a mean matrix, <span class="math inline">\(\nu\)</span> the degrees of freedom parameter, and <span class="math inline">\(\Gamma_p()\)</span> the multivariate gamma function, which is implemented in the <a href="http://gzt.github.io/CholWishart"><code>CholWishart</code></a> package available on CRAN.</p>
<p>For <span class="math inline">\(p = 1\)</span> and <span class="math inline">\(\Sigma = \nu\)</span> (or <span class="math inline">\(q = 1\)</span> and <span class="math inline">\(\Omega = \nu\)</span>), this reduces to the familiar multivariate <span class="math inline">\(t\)</span> distribution. If the <span class="math inline">\(p \times q\)</span> dimensional random variable <span class="math inline">\(X\)</span> follows the matrix variate <span class="math inline">\(t\)</span> distribution <span class="math inline">\(t(\nu, M, \Sigma, \Omega)\)</span> with center <span class="math inline">\(M\)</span>, positive definite spread matrices <span class="math inline">\(\Sigma\)</span> (<span class="math inline">\(p \times p\)</span>) and <span class="math inline">\(\Omega\)</span> (<span class="math inline">\(q \times q\)</span>), and degrees of freedom <span class="math inline">\(\nu\)</span>, it can be shown that, given a certain weight matrix <span class="math inline">\(S\)</span>, <span class="math inline">\(X\)</span> has a matrix variate normal distribution and that <span class="math inline">\(S\)</span> is Wishart-distributed. Specifically, <span class="math display">\[\begin{align*}
X | M, \Sigma, \Omega, \nu, S &amp; \sim  N(M, S^{-1} \otimes \Omega) \\
S|M, \Omega, \Sigma, \nu &amp; \sim  W_p(\nu + p  -1, \Sigma^{-1})
\end{align*}\]</span> Additionally, it can be shown the Wishart is the conjugate prior distribution for the parameter <span class="math inline">\(\Sigma\)</span>, and thus the conditional posterior distribution of <span class="math inline">\(S\)</span>, i.e., its distribution given <span class="math inline">\((M, \Omega, \Sigma, \nu, X)\)</span> is <span class="math display">\[S | X, M, \Omega, \Sigma, \nu \sim \mathrm{W}_p(\nu+p+q-1, [(X-M)\Omega^{-1}(X-M)^T + \Sigma]^{-1})   \]</span></p>
<p>For an observed set of <span class="math inline">\(X_i\)</span>, <span class="math inline">\(i = 1, 2, \ldots, N\)</span>, then, we can construct an ECM-style algorithm by augmenting our data with a set of weights, <span class="math inline">\(S_i\)</span>, and use this to estimate the parameters of the matrix variate <span class="math inline">\(t\)</span> distribution. Briefly, we define a set of complete data sufficient statistics based on the <span class="math inline">\(S_i\)</span> and update them with their expectations in the E-step. Then, the other parameters are maximized in the CM steps.</p>
<p>The complete data sufficient statistics for the quantities to be estimated are: <span class="math display">\[S_{SX} =\sum_{i = 1}^N S_i X_i; \quad S_S =  \sum_{i = 1}^N S_i; \quad S_{XSX} =  \sum_{i = 1}^N  X_i^T S_i X_i \quad S_{|S|} = \sum_{i = 1}^N \log |Si|\]</span></p>
<div id="e-step" class="section level3">
<h3 class="hasAnchor">
<a href="#e-step" class="anchor"></a>E-step</h3>
<p>Define at step <span class="math inline">\(t\)</span> the set <span class="math inline">\(\Theta^{(t)} = (X_{obs},\nu^{(t)}, M^{(t)}, \Sigma^{(t)}, \Omega^{(t)})\)</span>. Then, given these values, we have, based on the properties of the Wishart distribution, <span class="math display">\[S_{i}^{(t+1)} = E(S_i | \Theta^{(t)}) = (\nu^{(t)}+p+q-1)[(X_i-M^{(t)})\Omega^{(t)^{-1 }}(X_i-M^{(t)})^T + \Sigma^{(t)}]^{-1} \]</span> From this we can derive the other expected values: <span class="math display">\[
 \begin{align*}
S_{S}^{(t+1)} &amp;= E(S_S | \Theta^{(t)}) = \sum_{i=1}^N S_{i}^{(t+1)} \\
S_{SX}^{(t+1)} &amp;= E(S_{SX} | \Theta^{(t)}) =  \sum_{i=1}^NE(S_iX_i|\Theta^{(t)}) = \sum_{i=1}^N S_{i}^{(t+1)}X_i \\
S_{XSX}^{(t+1)} &amp;= E(S_{XSX} | \Theta^{(t)}) =  \sum_{i=1}^NE(X_i^TS_iX_i|\Theta^{(t)}) = \sum_{i=1}^N X_i^TS_{i}^{(t+1)}X_i
\end{align*}
\]</span> This last value only needs to be computed if <span class="math inline">\(\nu\)</span> is unknown: <span class="math display">\[
\begin{align*}
S_{|S|}^{(t+1)} &amp;= E(S_{|S|} | \Theta^{(t)}) = E \left[\sum_{i = 1}^N \log| S_i|  \big| \Theta^{(t)} \right]\\
&amp;=N\psi_{p}\left({\frac {\nu^{(t)} + p + q -1}{2}}\right) + Np \log 2 +\sum_{i=1}^N \log \left|\frac{S_{i,obs}^{(t+1)}}{\nu^{(t)} + p + q -1}\right|
\end{align*}
\]</span></p>
</div>
<div id="cm-steps" class="section level3">
<h3 class="hasAnchor">
<a href="#cm-steps" class="anchor"></a>CM Steps</h3>
<p>Similarly to the case of the multivariate <span class="math inline">\(t\)</span>, it is more efficient to partition the maximization step into multiple steps. This is an ECME algorithm that first maximizes the expected log-likelihood for <span class="math inline">\((M, \Sigma, \Omega)\)</span> and then maximizes the actual log-likelihood over <span class="math inline">\(\nu\)</span> given <span class="math inline">\((M, \Sigma, \Omega)\)</span>, similar to .</p>
<p>Based on the updated weight matrices <span class="math inline">\(S_i^{(t+1)}\)</span> and statistics based on <span class="math inline">\(\Theta^{(t)}\)</span> and <span class="math inline">\(X_{obs}\)</span>,</p>
<p><span class="math display">\[
\begin{align*}
\widehat{M} &amp;= \left(\sum_{i = 1}^NS_i^{(t+1)}\right)^{-1}\sum_{i=1}^NS_iX_i  = {S_{S}^{(t+1)}}^{-1} S_{SX}^{(t+1)} \\
\widehat{\Omega} &amp;= \frac{1}{Np} \sum_{i = 1}^N (X_i - {M}^{(t)})^T S_i^{(t+1)} (X_i - {M}^{(t)}) =\frac{1}{Np} \left(S_{XSX}^{(t+1)} - {S_{SX}^{(t+1)}}^T {S_{S}^{(t+1)}}^{-1}{S_{SX}^{(t+1)}}  \right) \\
 \widehat{\Sigma}^{-1} &amp;= \frac{1}{N(\nu^{(t)}+p-1)}\sum_{i = 1}^N S_i^{(t+1)} = \frac{S_S^{(t+1)}}{N(\nu^{(t)}+p-1)}
\end{align*}
\]</span> And, again, with the set of <span class="math inline">\(S_i\)</span> observed, the MLE of <span class="math inline">\(\nu\)</span> can be obtained: <span class="math display">\[ N \frac{d}{d\nu}\log \Gamma_p ((\nu+p-1)/2) - \frac{1}{2} (S_{|S|} - Np\log2 + N \log |\widehat{\Sigma}|) = 0\]</span> Note that <span class="math inline">\(\nu &gt; p -1\)</span>. Specifically, we have: <span class="math display">\[
\begin{align*}
 0 &amp;= N \psi_p((\nu+p-1)/2) -  \left(N\psi_{p}\left({\frac {\nu + p + q -1}{2}}\right)  +\sum_{i=1}^N \log \left|\frac{S_{i,obs}^{(t+1)}}{\nu + p + q -1}\right| - N \log \left|\frac{S_S^{(t+1)}}{N(\nu+p-1)}\right|\right) \\*
 &amp;=  \psi_p((\nu+p-1)/2) - \left(\psi_{p}\left({\frac {\nu + p + q -1}{2}}\right)  +\frac{1}{N}\sum_{i=1}^N \log \left|Z_{i,obs}^{(t+1)}\right| + p \log \frac{N(\nu + p -1)}{\nu + p +q -1} - \log \left|Z_S^{(t+1)}\right|\right)
\end{align*}\]</span> where <span class="math inline">\(Z_{*}\)</span> is the appropriate <span class="math inline">\(S_{*}\)</span> statistic with <span class="math inline">\((\nu + p + q -1)\)</span> factored out and <span class="math inline">\(\psi_p\)</span> is the <span class="math inline">\(p\)</span>-dimensional digamma function. This can be solved for <span class="math inline">\(\nu\)</span> using a 1-dimensional search.</p>
</div>
</div>
<div id="applications-and-results" class="section level2">
<h2 class="hasAnchor">
<a href="#applications-and-results" class="anchor"></a>Applications and results</h2>
<div id="with-nu-known" class="section level3">
<h3 class="hasAnchor">
<a href="#with-nu-known" class="anchor"></a>With <span class="math inline">\(\nu\)</span> known</h3>
<p>If the degrees of freedom parameter, <span class="math inline">\(\nu\)</span> known, the estimation is fairly straightforward. The procedure is similar to the multivariate <span class="math inline">\(t\)</span> or the matrix variate normal. In this case, the interface is just like the interface for the <code><a href="../reference/MLmatrixnorm.html">MLmatrixnorm()</a></code> function:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">20190622</span>)
<span class="no">sigma</span> <span class="kw">=</span> (<span class="fl">1</span>/<span class="fl">7</span>) * <span class="fu"><a href="https://rdrr.io/r/stats/rWishart.html">rWishart</a></span>(<span class="fl">1</span>, <span class="fl">7</span>, <span class="fl">1</span>*<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fl">3</span>:<span class="fl">1</span>))[,,<span class="fl">1</span>]
<span class="no">A</span> <span class="kw">=</span> <span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span>(<span class="kw">n</span><span class="kw">=</span><span class="fl">100</span>,<span class="kw">mean</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">100</span>,<span class="fl">0</span>,-<span class="fl">100</span>,<span class="fl">0</span>,<span class="fl">25</span>,-<span class="fl">1000</span>),<span class="kw">nrow</span><span class="kw">=</span><span class="fl">2</span>),
   <span class="kw">V</span> <span class="kw">=</span> <span class="no">sigma</span>, <span class="kw">df</span> <span class="kw">=</span> <span class="fl">7</span>)
<span class="no">results</span><span class="kw">=</span><span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span>(<span class="no">A</span>, <span class="kw">df</span> <span class="kw">=</span> <span class="fl">7</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">results</span>)
<span class="co">#&gt; $mean</span>
<span class="co">#&gt;            [,1]          [,2]        [,3]</span>
<span class="co">#&gt; [1,] 99.8291911 -1.000708e+02    25.01042</span>
<span class="co">#&gt; [2,] -0.0425028 -8.261356e-03 -1000.02357</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $U</span>
<span class="co">#&gt;             [,1]        [,2]</span>
<span class="co">#&gt; [1,]  1.00000000 -0.08039981</span>
<span class="co">#&gt; [2,] -0.08039981  0.97069319</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $V</span>
<span class="co">#&gt;           [,1]       [,2]       [,3]</span>
<span class="co">#&gt; [1,] 1.0000000 0.21375613 0.11094767</span>
<span class="co">#&gt; [2,] 0.2137561 0.14872070 0.04098332</span>
<span class="co">#&gt; [3,] 0.1109477 0.04098332 0.12860660</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $var</span>
<span class="co">#&gt; [1] 5.148569</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $nu</span>
<span class="co">#&gt; [1] 7</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $iter</span>
<span class="co">#&gt; [1] 44</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $tol</span>
<span class="co">#&gt; [1] 1.155396e-08</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $logLik</span>
<span class="co">#&gt; [1] -386.7623</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $convergence</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $call</span>
<span class="co">#&gt; MLmatrixt(data = A, df = 7)</span></pre></body></html></div>
<p>There are two restrictions possible for the mean matrices: <code>row.mean = TRUE</code> will force a common mean within a row and <code>col.mean = TRUE</code> will force a common mean within a column. Setting both will ensure a constant mean for the entire system. Restrictions on <span class="math inline">\(\mathbf{U}\)</span> and <span class="math inline">\(\mathbf{V}\)</span>, the row-wise variance and column-wise variance, are possible with <code>row.variance</code> and <code>col.variance</code> commands.</p>
<p>The options for variance restrictions are the same as for the <code><a href="../reference/MLmatrixnorm.html">MLmatrixnorm()</a></code> function. Currently the options for variance restrictions are to impose an AR(1) structure by providing the <code>AR(1)</code> option, a compound symmetry structure by providing the <code>CS</code> option, to impose a correlation matrix structure by specifying <code>correlation</code> or <code>corr</code>, or to impose an identical and independent structure by specifying <code>Independent</code> or <code>I</code>. This works by using <code>uniroot</code> to find the appropriate <span class="math inline">\(\rho\)</span> which sets the derivative of the log-likelihood to zero for the <code>AR</code> and <code>CS</code> options - it is not fast but if this is the true structure it will be better in some sense than an unstructured variance matrix. The <span class="math inline">\(\rho\)</span> parameter should be <span class="math inline">\(&gt;0\)</span> and is forced to be non-negative. If the data behaves incompatibly with those restrictions, the function will provide a warning and exit with the current model fit.</p>
</div>
<div id="with-nu-unknown" class="section level3">
<h3 class="hasAnchor">
<a href="#with-nu-unknown" class="anchor"></a>With <span class="math inline">\(\nu\)</span> unknown</h3>
<p>Estimation of <span class="math inline">\(\nu\)</span>, the degrees of freedom parameter, is slow and the principal mathematical difficulty of the matrix-variate <span class="math inline">\(t\)</span> distribution. It is performed using ECME. Generally, a fair amount more data are needed in order to have good convergence properties for the estimator, but they have not been derived analytically. Here you can see the recovery of the parameter for a few sample sizes. Because of the relative slowness of running a longer simulation, this only includes one set of examples. I give code for a longer and larger simulation than what is plotted if you’re really interested below. What is plotted below is only the <code>df = 10</code> example with 75 trials and a maximum number of iterations <code>max.iter =  20</code>. The full simulation may take several minutes.</p>
<p><img src="matrix-t-estimation_files/figure-html/dftenexample-1.png" width="700"></p>
<table class="table">
<thead><tr class="header">
<th align="left">samplesize</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">median</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">25</td>
<td align="right">7.059192</td>
<td align="right">15.76929</td>
<td align="right">10.316514</td>
<td align="right">10.512701</td>
<td align="right">2.0603677</td>
</tr>
<tr class="even">
<td align="left">50</td>
<td align="right">7.220806</td>
<td align="right">14.47148</td>
<td align="right">10.424858</td>
<td align="right">10.415426</td>
<td align="right">1.6347640</td>
</tr>
<tr class="odd">
<td align="left">100</td>
<td align="right">8.281614</td>
<td align="right">11.85454</td>
<td align="right">9.826301</td>
<td align="right">9.859941</td>
<td align="right">0.8019631</td>
</tr>
</tbody>
</table>
<p>As expected, increased sample size leads to better results in recovering the parameter. The results for smaller sample sizes would be more divergent if left to run until convergence.</p>
</div>
</div>
<div id="use-for-classification" class="section level2">
<h2 class="hasAnchor">
<a href="#use-for-classification" class="anchor"></a>Use for classification</h2>
<p>Using the <span class="math inline">\(t\)</span> distribution works in both <code><a href="../reference/matrixlda.html">matrixlda()</a></code> and <code><a href="../reference/matrixqda.html">matrixqda()</a></code> as expected by specifying <code>method = "t"</code> and providing either a single parameter (for <code>lda</code> or <code>qda</code>) for the degrees of freedom or a vector as long as the number of classes (for <code>qda</code>). Additional parameters for fitting can be passed through the <code>...</code> to <code><a href="../reference/MLmatrixt.html">MLmatrixt()</a></code> just as for the normal case, including estimating the degrees of freedom parameter. The <code>qda</code> will only estimate <code>nu</code> with it varying between groups, it will not estimate a common <code>nu</code>.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">A</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span>(<span class="fl">30</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">0</span>, <span class="kw">nrow</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">ncol</span><span class="kw">=</span><span class="fl">3</span>), <span class="kw">df</span> <span class="kw">=</span> <span class="fl">10</span>)
<span class="no">B</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span>(<span class="fl">30</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">0</span>), <span class="kw">nrow</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">ncol</span><span class="kw">=</span><span class="fl">3</span>), <span class="kw">df</span> <span class="kw">=</span> <span class="fl">10</span>)
<span class="no">C</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span>(<span class="fl">30</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">1</span>), <span class="kw">nrow</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">ncol</span><span class="kw">=</span><span class="fl">3</span>), <span class="kw">df</span> <span class="kw">=</span> <span class="fl">10</span>)
<span class="no">ABC</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">A</span>,<span class="no">B</span>,<span class="no">C</span>), <span class="kw">dim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">90</span>))
<span class="no">groups</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"A"</span>,<span class="fl">30</span>),<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"B"</span>,<span class="fl">30</span>),<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"C"</span>,<span class="fl">30</span>)))
<span class="no">prior</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">30</span>,<span class="fl">30</span>,<span class="fl">30</span>)/<span class="fl">90</span>
<span class="no">matlda</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/matrixlda.html">matrixlda</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">ABC</span>,<span class="kw">grouping</span> <span class="kw">=</span> <span class="no">groups</span>, <span class="kw">prior</span> <span class="kw">=</span> <span class="no">prior</span>,
                    <span class="kw">method</span> <span class="kw">=</span> <span class="st">'t'</span>, <span class="kw">nu</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">fixed</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="no">matlda</span>, <span class="kw">newdata</span> <span class="kw">=</span> <span class="no">ABC</span>[,,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">31</span>,<span class="fl">61</span>)])
<span class="co">#&gt; $class</span>
<span class="co">#&gt; [1] A B C</span>
<span class="co">#&gt; Levels: A B C</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $posterior</span>
<span class="co">#&gt;              [,1]         [,2]         [,3]</span>
<span class="co">#&gt; [1,] 9.997064e-01 2.849389e-04 8.693417e-06</span>
<span class="co">#&gt; [2,] 4.174839e-05 9.999508e-01 7.439619e-06</span>
<span class="co">#&gt; [3,] 8.908508e-06 4.857627e-06 9.999862e-01</span></pre></body></html></div>
</div>
<div id="session-info" class="section level2">
<h2 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session info</h2>
<p>This vignette was built using <code>rmarkdown</code>.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()
<span class="co">#&gt; R version 3.6.3 (2020-02-29)</span>
<span class="co">#&gt; Platform: x86_64-apple-darwin15.6.0 (64-bit)</span>
<span class="co">#&gt; Running under: macOS Catalina 10.15.3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib</span>
<span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt; [1] magrittr_1.5    dplyr_0.8.5     ggplot2_3.3.0   MixMatrix_0.2.5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;  [1] Rcpp_1.0.4         highr_0.8          compiler_3.6.3     pillar_1.4.3      </span>
<span class="co">#&gt;  [5] tools_3.6.3        digest_0.6.25      evaluate_0.14      memoise_1.1.0     </span>
<span class="co">#&gt;  [9] lifecycle_0.2.0    tibble_3.0.0       gtable_0.3.0       pkgconfig_2.0.3   </span>
<span class="co">#&gt; [13] rlang_0.4.5        cli_2.0.2          yaml_2.2.1         pkgdown_1.5.0.9000</span>
<span class="co">#&gt; [17] xfun_0.12          withr_2.1.2        stringr_1.4.0      knitr_1.28        </span>
<span class="co">#&gt; [21] desc_1.2.0         fs_1.4.0           vctrs_0.2.4        tidyselect_1.0.0  </span>
<span class="co">#&gt; [25] rprojroot_1.3-2    grid_3.6.3         glue_1.3.2         R6_2.4.1          </span>
<span class="co">#&gt; [29] fansi_0.4.1        rmarkdown_2.1      farver_2.0.3       purrr_0.3.3       </span>
<span class="co">#&gt; [33] backports_1.1.5    scales_1.1.0       htmltools_0.4.0    ellipsis_0.3.0    </span>
<span class="co">#&gt; [37] MASS_7.3-51.5      CholWishart_1.1.0  assertthat_0.2.1   colorspace_1.4-1  </span>
<span class="co">#&gt; [41] labeling_0.3       stringi_1.4.6      munsell_0.5.0      crayon_1.3.4</span></pre></body></html></div>
</div>
<div id="all-the-code-for-easy-copying" class="section level2">
<h2 class="hasAnchor">
<a href="#all-the-code-for-easy-copying" class="anchor"></a>All the code for easy copying</h2>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span>$<span class="fu">set</span>(
  <span class="kw">collapse</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
  <span class="kw">comment</span> <span class="kw">=</span> <span class="st">"#&gt;"</span>
)
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">20190622</span>)
<span class="no">sigma</span> <span class="kw">=</span> (<span class="fl">1</span>/<span class="fl">7</span>) * <span class="fu"><a href="https://rdrr.io/r/stats/rWishart.html">rWishart</a></span>(<span class="fl">1</span>, <span class="fl">7</span>, <span class="fl">1</span>*<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fl">3</span>:<span class="fl">1</span>))[,,<span class="fl">1</span>]
<span class="no">A</span> <span class="kw">=</span> <span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span>(<span class="kw">n</span><span class="kw">=</span><span class="fl">100</span>,<span class="kw">mean</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">100</span>,<span class="fl">0</span>,-<span class="fl">100</span>,<span class="fl">0</span>,<span class="fl">25</span>,-<span class="fl">1000</span>),<span class="kw">nrow</span><span class="kw">=</span><span class="fl">2</span>),
   <span class="kw">V</span> <span class="kw">=</span> <span class="no">sigma</span>, <span class="kw">df</span> <span class="kw">=</span> <span class="fl">7</span>)
<span class="no">results</span><span class="kw">=</span><span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span>(<span class="no">A</span>, <span class="kw">df</span> <span class="kw">=</span> <span class="fl">7</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">results</span>)
<span class="co">### Here is the long simulation</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">20181102</span>)

<span class="no">df</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span>)
<span class="no">df5</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>,<span class="fl">200</span>)
<span class="no">df10</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>,<span class="fl">200</span>)
<span class="no">df100</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>,<span class="fl">200</span>)
<span class="no">df550</span> <span class="kw">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>,<span class="fl">200</span>)
<span class="no">df1050</span> <span class="kw">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>,<span class="fl">200</span>)
<span class="no">df2050</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>,<span class="fl">200</span>)
<span class="no">df5100</span> <span class="kw">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>,<span class="fl">200</span>)
<span class="no">df10100</span> <span class="kw">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>,<span class="fl">200</span>)
<span class="no">df20100</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>,<span class="fl">200</span>)

<span class="no">meanmat</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">0</span>,<span class="fl">5</span>,<span class="fl">3</span>)
<span class="no">U</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fl">5</span>)
<span class="no">V</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fl">3</span>)

<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fl">200</span>){
    <span class="no">df5</span>[<span class="no">i</span>] <span class="kw">=</span> <span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span>(<span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span>(<span class="kw">mean</span> <span class="kw">=</span> <span class="no">meanmat</span>,
        <span class="kw">df</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="fl">35</span>, <span class="kw">U</span> <span class="kw">=</span><span class="no">U</span>, <span class="kw">V</span> <span class="kw">=</span><span class="no">V</span>), <span class="kw">fixed</span> <span class="kw">=</span> <span class="fl">FALSE</span>)$<span class="no">nu</span>
    <span class="no">df10</span>[<span class="no">i</span>] <span class="kw">=</span> <span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span>(<span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span>(<span class="kw">mean</span> <span class="kw">=</span> <span class="no">meanmat</span>,
        <span class="kw">df</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="fl">35</span>, <span class="kw">U</span> <span class="kw">=</span><span class="no">U</span>, <span class="kw">V</span> <span class="kw">=</span><span class="no">V</span>), <span class="kw">fixed</span> <span class="kw">=</span> <span class="fl">FALSE</span>)$<span class="no">nu</span>
    <span class="no">df100</span>[<span class="no">i</span>] <span class="kw">=</span> <span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span>(<span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span>(<span class="kw">mean</span> <span class="kw">=</span> <span class="no">meanmat</span>,
        <span class="kw">df</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="fl">35</span>, <span class="kw">U</span> <span class="kw">=</span><span class="no">U</span>, <span class="kw">V</span> <span class="kw">=</span><span class="no">V</span>), <span class="kw">fixed</span> <span class="kw">=</span> <span class="fl">FALSE</span>)$<span class="no">nu</span>
    <span class="no">df550</span>[<span class="no">i</span>] <span class="kw">=</span> <span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span>(<span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span>(<span class="kw">mean</span> <span class="kw">=</span> <span class="no">meanmat</span>,
        <span class="kw">df</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="fl">50</span>, <span class="kw">U</span> <span class="kw">=</span><span class="no">U</span>, <span class="kw">V</span> <span class="kw">=</span><span class="no">V</span>), <span class="kw">fixed</span> <span class="kw">=</span> <span class="fl">FALSE</span>)$<span class="no">nu</span>
    <span class="no">df1050</span>[<span class="no">i</span>] <span class="kw">=</span> <span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span>(<span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span>(<span class="kw">mean</span> <span class="kw">=</span> <span class="no">meanmat</span>,
        <span class="kw">df</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="fl">50</span>, <span class="kw">U</span> <span class="kw">=</span><span class="no">U</span>, <span class="kw">V</span> <span class="kw">=</span><span class="no">V</span>), <span class="kw">fixed</span> <span class="kw">=</span> <span class="fl">FALSE</span>)$<span class="no">nu</span>
    <span class="no">df2050</span>[<span class="no">i</span>] <span class="kw">=</span> <span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span>(<span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span>(<span class="kw">mean</span> <span class="kw">=</span> <span class="no">meanmat</span>,
        <span class="kw">df</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="fl">50</span>, <span class="kw">U</span> <span class="kw">=</span><span class="no">U</span>, <span class="kw">V</span> <span class="kw">=</span><span class="no">V</span>), <span class="kw">fixed</span> <span class="kw">=</span> <span class="fl">FALSE</span>)$<span class="no">nu</span>
    <span class="no">df5100</span>[<span class="no">i</span>] <span class="kw">=</span> <span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span>(<span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span>(<span class="kw">mean</span> <span class="kw">=</span> <span class="no">meanmat</span>,
        <span class="kw">df</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">U</span> <span class="kw">=</span><span class="no">U</span>, <span class="kw">V</span> <span class="kw">=</span><span class="no">V</span>), <span class="kw">fixed</span> <span class="kw">=</span> <span class="fl">FALSE</span>)$<span class="no">nu</span>
    <span class="no">df10100</span>[<span class="no">i</span>] <span class="kw">=</span> <span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span>(<span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span>(<span class="kw">mean</span> <span class="kw">=</span> <span class="no">meanmat</span>,
        <span class="kw">df</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">U</span> <span class="kw">=</span><span class="no">U</span>, <span class="kw">V</span> <span class="kw">=</span><span class="no">V</span>), <span class="kw">fixed</span> <span class="kw">=</span> <span class="fl">FALSE</span>)$<span class="no">nu</span>
    <span class="no">df20100</span>[<span class="no">i</span>] <span class="kw">=</span> <span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span>(<span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span>(<span class="kw">mean</span> <span class="kw">=</span> <span class="no">meanmat</span>,
        <span class="kw">df</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">U</span> <span class="kw">=</span><span class="no">U</span>, <span class="kw">V</span> <span class="kw">=</span><span class="no">V</span>), <span class="kw">fixed</span> <span class="kw">=</span> <span class="fl">FALSE</span>)$<span class="no">nu</span>
}

<span class="no">truedataframe</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">truedf</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">20</span>),
                                           <span class="kw">label</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'5 df'</span>, <span class="st">'10 df'</span>, <span class="st">'20 df'</span>)),
                           <span class="kw">estdf</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">20</span>))

<span class="no">dfdataframe</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">truedf</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">20</span>), <span class="kw">each</span> <span class="kw">=</span> <span class="fl">200</span>),<span class="fl">3</span>),
                                         <span class="kw">label</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'5 df'</span>, <span class="st">'10 df'</span>, <span class="st">'20 df'</span>)),
                         <span class="kw">estdf</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">df5</span>, <span class="no">df10</span>, <span class="no">df100</span>, <span class="no">df550</span>, <span class="no">df1050</span>, <span class="no">df2050</span>, <span class="no">df5100</span>, <span class="no">df10100</span>, <span class="no">df20100</span>),
                         <span class="kw">samplesize</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">35</span>,<span class="fl">50</span>,<span class="fl">100</span>), <span class="kw">each</span> <span class="kw">=</span> <span class="fl">600</span>)))
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyverse</span>)

<span class="no">denseplot</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(<span class="no">dfdataframe</span>, <span class="no">estdf</span> <span class="kw">&lt;</span> <span class="fl">200</span>),
                    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">estdf</span>, <span class="kw">fill</span><span class="kw">=</span><span class="no">samplesize</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.5</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">truedataframe</span>,
               <span class="kw">mapping</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">xintercept</span> <span class="kw">=</span> <span class="no">estdf</span>),
               <span class="kw">size</span> <span class="kw">=</span> <span class="fl">.5</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.ticks.y</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(), <span class="kw">axis.text.y</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
          <span class="kw">strip.text</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">8</span>),
          <span class="kw">legend.justification</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">0</span>), <span class="kw">legend.position</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.95</span>,<span class="fl">.4</span>),
          <span class="kw">legend.background</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
          <span class="kw">legend.text</span> <span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">8</span>), <span class="kw">legend.title</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">8</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Density plot of estimated degrees of freedom compared to actual"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span>(<span class="kw">NULL</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="kw">NULL</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span>(<span class="kw">values</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"#050505"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>),
        <span class="kw">name</span> <span class="kw">=</span> <span class="st">"Sample Size"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">truedf</span>)~<span class="no">.</span>,  <span class="kw">scales</span><span class="kw">=</span><span class="st">"free"</span>) +
    <span class="kw">NULL</span>
<span class="no">denseplot</span>


<span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="no">dfdataframe</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">truedf</span>, <span class="no">samplesize</span>) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(<span class="kw">min</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="no">estdf</span>), <span class="kw">max</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">estdf</span>),
    <span class="kw">median</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="no">estdf</span>),
    <span class="kw">mean</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">estdf</span>),
    <span class="kw">sd</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="no">estdf</span>)))
<span class="co">### Here ends the long simulation</span>

<span class="co">##### Here is what is really run</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">20190621</span>)
<span class="no">df10</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>,<span class="fl">50</span>)
<span class="no">df1050</span> <span class="kw">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>,<span class="fl">50</span>)
<span class="no">df10100</span> <span class="kw">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>,<span class="fl">50</span>)

<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fl">50</span>){
   <span class="no">df10</span>[<span class="no">i</span>] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span>(<span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span>(<span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span>(<span class="kw">mean</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">0</span>,<span class="fl">5</span>,<span class="fl">3</span>),<span class="kw">df</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="fl">25</span>), <span class="kw">fixed</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">df</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">max.iter</span> <span class="kw">=</span> <span class="fl">20</span>)$<span class="no">nu</span>)
   <span class="no">df1050</span>[<span class="no">i</span>] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span>(<span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span>(<span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span>(<span class="kw">mean</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">0</span>,<span class="fl">5</span>,<span class="fl">3</span>),<span class="kw">df</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="fl">50</span>), <span class="kw">fixed</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">df</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">max.iter</span> <span class="kw">=</span> <span class="fl">20</span>)$<span class="no">nu</span>)
   <span class="no">df10100</span>[<span class="no">i</span>] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span>(<span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span>(<span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span>(<span class="kw">mean</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">0</span>,<span class="fl">5</span>,<span class="fl">3</span>),<span class="kw">df</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="fl">100</span>), <span class="kw">fixed</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">df</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">max.iter</span> <span class="kw">=</span> <span class="fl">20</span>)$<span class="no">nu</span>)
}


<span class="no">dfdataframe</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">label</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'10 df'</span>),
                         <span class="kw">estdf</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">df10</span>, <span class="no">df1050</span>, <span class="no">df10100</span>),
                         <span class="kw">samplesize</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">25</span>,<span class="fl">50</span>,<span class="fl">100</span>), <span class="kw">each</span> <span class="kw">=</span> <span class="fl">50</span>)))
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">magrittr</span>)
<span class="no">denseplot</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(<span class="no">dfdataframe</span>, <span class="no">estdf</span> <span class="kw">&lt;</span> <span class="fl">200</span>),<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">estdf</span>, <span class="kw">fill</span><span class="kw">=</span><span class="no">samplesize</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">.5</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span>(<span class="kw">mapping</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">xintercept</span> <span class="kw">=</span> <span class="fl">10</span>),
               <span class="kw">size</span> <span class="kw">=</span> <span class="fl">.5</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.ticks.y</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(), <span class="kw">axis.text.y</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(), <span class="kw">strip.text</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">8</span>),
          <span class="kw">legend.justification</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">0</span>), <span class="kw">legend.position</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.95</span>,<span class="fl">.4</span>),
          <span class="kw">legend.background</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
          <span class="kw">legend.text</span> <span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">8</span>), <span class="kw">legend.title</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">8</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Density plot of estimated degrees of freedom compared to actual"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span>(<span class="kw">NULL</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="kw">NULL</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span>(<span class="kw">values</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"#050505"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>), <span class="kw">name</span> <span class="kw">=</span> <span class="st">"Sample Size"</span>) +
 <span class="co">#   facet_wrap(factor(truedf)~.,  scales="free") +</span>
    <span class="kw">NULL</span>
<span class="no">denseplot</span>


<span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="no">dfdataframe</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">samplesize</span>) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(<span class="kw">min</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="no">estdf</span>), <span class="kw">max</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">estdf</span>),
    <span class="kw">median</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="no">estdf</span>),
    <span class="kw">mean</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">estdf</span>),
    <span class="kw">sd</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="no">estdf</span>)))

<span class="co">#### Here ends what is really run</span>

<span class="no">A</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span>(<span class="fl">30</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">0</span>, <span class="kw">nrow</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">ncol</span><span class="kw">=</span><span class="fl">3</span>), <span class="kw">df</span> <span class="kw">=</span> <span class="fl">10</span>)
<span class="no">B</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span>(<span class="fl">30</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">0</span>), <span class="kw">nrow</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">ncol</span><span class="kw">=</span><span class="fl">3</span>), <span class="kw">df</span> <span class="kw">=</span> <span class="fl">10</span>)
<span class="no">C</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span>(<span class="fl">30</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">1</span>), <span class="kw">nrow</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">ncol</span><span class="kw">=</span><span class="fl">3</span>), <span class="kw">df</span> <span class="kw">=</span> <span class="fl">10</span>)
<span class="no">ABC</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">A</span>,<span class="no">B</span>,<span class="no">C</span>), <span class="kw">dim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">90</span>))
<span class="no">groups</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"A"</span>,<span class="fl">30</span>),<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"B"</span>,<span class="fl">30</span>),<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"C"</span>,<span class="fl">30</span>)))
<span class="no">prior</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">30</span>,<span class="fl">30</span>,<span class="fl">30</span>)/<span class="fl">90</span>
<span class="no">matlda</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/matrixlda.html">matrixlda</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">ABC</span>,<span class="kw">grouping</span> <span class="kw">=</span> <span class="no">groups</span>, <span class="kw">prior</span> <span class="kw">=</span> <span class="no">prior</span>,
                    <span class="kw">method</span> <span class="kw">=</span> <span class="st">'t'</span>, <span class="kw">nu</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">fixed</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="no">matlda</span>, <span class="kw">newdata</span> <span class="kw">=</span> <span class="no">ABC</span>[,,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">31</span>,<span class="fl">61</span>)])

<span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()</pre></body></html></div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-dickey1967">
<p>Dickey, James M. 1967. “Matricvariate Generalizations of the Multivariate <span class="math inline">\(t\)</span> Distribution and the Inverted Multivariate <span class="math inline">\(t\)</span> Distribution.” <em>Ann. Math. Statist.</em> 38 (2): 511–18. <a href="https://doi.org/10.1214/aoms/1177698967">https://doi.org/10.1214/aoms/1177698967</a>.</p>
</div>
<div id="ref-liurubin1994">
<p>Liu, Chuanhai, and Donald B. Rubin. 1994. “The ECME Algorithm: A Simple Extension of EM and ECM with Faster Monotone Convergence.” <em>Biometrika</em> 81 (4): 633–48. <a href="https://doi.org/10.2307/2337067">https://doi.org/10.2307/2337067</a>.</p>
</div>
<div id="ref-meng1993">
<p>Meng, Xiao-Li, and Donald B. Rubin. 1993. “Maximum Likelihood Estimation via the ECM Algorithm: A General Framework.” <em>Biometrika</em> 80 (2): 267–78. <a href="https://doi.org/10.1093/biomet/80.2.267">https://doi.org/10.1093/biomet/80.2.267</a>.</p>
</div>
<div id="ref-rubin1983">
<p>Rubin, D. B. 1983. “Encyclopedia of Statistical Sciences.” In, 4th ed., 272–5. John Wiley.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Geoffrey Thompson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
