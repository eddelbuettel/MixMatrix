<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Geoffrey Thompson" />


<title>Matrix Variate Normal Distributions</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Matrix Variate Normal Distributions</h1>
<h4 class="author"><em>Geoffrey Thompson</em></h4>
<h4 class="date"><em>February 3, 2018</em></h4>



<hr />
<div id="matrix-variate-distributions" class="section level2">
<h2>Matrix Variate Distributions</h2>
<p>Suppose there is a two-dimensional grid of observations: each observation is randomly distributed somehow, perhaps each spot on the grid has its own mean, there’s a covariance relation across the rows that doesn’t vary across the columns and a covariance relation across the columns that doesn’t vary across the rows. One case where this might come up is multivariate time series: at each point in time we are dealing with a multivariate observation (perhaps normally distributed or not) and then there is a covariance structure across time to account for. We may be interested in drawing from such random variables, calculating densities, or fitting parameters for such distributions based on observations of those distributions. Here I have some functions for doing so in the case of matrix variate normal distributions. For more details about matrix variate distributions in general and matrix variate normal distributions in particular, see <span class="citation">Gupta and Nagar (1999)</span>, whose results I rely on for much of this presentation.</p>
</div>
<div id="matrix-variate-normal-distributions" class="section level2">
<h2>Matrix Variate Normal Distributions</h2>
<p>A random matrix <span class="math inline">\(\mathbf{X}\)</span> <span class="math inline">\((p \times n)\)</span> with a matrix variate normal distribution is parameterized by a mean matrix <span class="math inline">\(\mathbf{M}\)</span> <span class="math inline">\((p \times n)\)</span> and covariance matrices <span class="math inline">\(\mathbf{U}\)</span> <span class="math inline">\((p \times p)\)</span> (determining covariance among rows) and <span class="math inline">\(\mathbf{V}\)</span> <span class="math inline">\((n \times n)\)</span> (determining covariance among columns) and has the following probability density function (<span class="citation">Wikipedia (2018)</span>): <span class="math display">\[p(\mathbf{X}\mid\mathbf{M}, \mathbf{U}, \mathbf{V}) = \frac{\exp\left( -\frac{1}{2} \, \mathrm{tr}\left[ \mathbf{V}^{-1} (\mathbf{X} - \mathbf{M})^{T} \mathbf{U}^{-1} (\mathbf{X} - \mathbf{M}) \right] \right)}{(2\pi)^{np/2} |\mathbf{V}|^{n/2} |\mathbf{U}|^{p/2}} \]</span> Here is a useful fact for drawing observations from a matrix variate normal distribution: suppose <span class="math inline">\(\mathbf{X}\)</span> is distributed as a matrix variate normal distribution with mean matrix <span class="math inline">\(\mathbf{0}\)</span> and covariance matrices <span class="math inline">\(\mathbf{I_n}\)</span> and <span class="math inline">\(\mathbf{I_p}\)</span>. Then for a mean matrix <span class="math inline">\(\mathbf{M}\)</span> and linear transformations <span class="math inline">\(\mathbf{L}\)</span> and <span class="math inline">\(\mathbf{R}\)</span> of appropriate dimensions, if <span class="math display">\[Y = \mathbf{M} + \mathbf{L}\mathbf{X}\mathbf{R}\]</span> then <span class="math inline">\(\mathbf{Y}\)</span> is matrix variate normally distributed with parameters <span class="math inline">\(\mathbf{M}, \mathbf{LL}^T, \mathbf{R}^T\mathbf{R}\)</span>.</p>
<p>Matrix variate random variables can then be generated by specifying <span class="math inline">\(\mathbf{M}\)</span> and <span class="math inline">\(\mathbf{L}\)</span> and <span class="math inline">\(\mathbf{R}\)</span> or by specifying <span class="math inline">\(\mathbf{U}\)</span> and <span class="math inline">\(\mathbf{V}\)</span>. If the covariance matrices are provided, then Cholesky decomposition is performed to create the <span class="math inline">\(\mathbf{L}\)</span> and <span class="math inline">\(\mathbf{R}\)</span> matrices. If <span class="math inline">\(\mathbf{L}\)</span> and <span class="math inline">\(\mathbf{R}\)</span> matrices are provided, they are used to create <span class="math inline">\(\mathbf{U}\)</span> and <span class="math inline">\(\mathbf{V}\)</span> matrices which are then decomposed. If these are not specifed, the variances are presumed to be identity matrices by default and the means are presumed to be zero.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">20180203</span>)
x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">6</span>),<span class="dt">nrow=</span><span class="dv">3</span>)
x</code></pre></div>
<pre><code>            [,1]      [,2]
[1,]  0.04234611 1.7072872
[2,] -1.05186238 0.2182058
[3,]  0.36199161 0.6759820</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">20180203</span>)
y &lt;-<span class="st"> </span><span class="kw">rmatrixnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mean=</span><span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">6</span>),<span class="dt">nrow=</span><span class="dv">3</span>))
y</code></pre></div>
<pre><code>            [,1]      [,2]
[1,]  0.04234611 1.7072872
[2,] -1.05186238 0.2182058
[3,]  0.36199161 0.6759820</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">U &lt;-<span class="st"> </span><span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="kw">diag</span>(<span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
V &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">2</span>)
mu =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,<span class="dt">nrow=</span><span class="dv">3</span>)
<span class="kw">set.seed</span>(<span class="dv">20180203</span>)
z &lt;-<span class="st"> </span><span class="kw">rmatrixnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mean=</span>mu,<span class="dt">U=</span>U,<span class="dt">V=</span>V)
z</code></pre></div>
<pre><code>          [,1]     [,2]
[1,]  1.146691 5.322459
[2,] -1.568345 5.387067
[3,]  3.734947 6.755212</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mu <span class="op">+</span><span class="st"> </span><span class="kw">t</span>(<span class="kw">chol</span>(U)) <span class="op">%*%</span><span class="st"> </span>y <span class="op">%*%</span><span class="st"> </span><span class="kw">chol</span>(V)</code></pre></div>
<pre><code>          [,1]     [,2]
[1,]  1.146691 5.322459
[2,] -1.568345 5.387067
[3,]  3.734947 6.755212</code></pre>
<p>When <span class="math inline">\(n=1\)</span>, by default this returns a matrix. For <span class="math inline">\(n&gt;1\)</span>, by default, it will return a three-dimensional array indexed by the first coordinate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">20180203</span>)
x &lt;-<span class="st"> </span><span class="kw">rmatrixnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mean=</span><span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">6</span>),<span class="dt">nrow=</span><span class="dv">3</span>))
x</code></pre></div>
<pre><code>            [,1]      [,2]
[1,]  0.04234611 1.7072872
[2,] -1.05186238 0.2182058
[3,]  0.36199161 0.6759820</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">20180203</span>)
y &lt;-<span class="st"> </span><span class="kw">rmatrixnorm</span>(<span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">mean=</span><span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">6</span>),<span class="dt">nrow=</span><span class="dv">3</span>),<span class="dt">list =</span> <span class="ot">TRUE</span>)
y[[<span class="dv">1</span>]]</code></pre></div>
<pre><code>            [,1]      [,2]
[1,]  0.04234611 1.7072872
[2,] -1.05186238 0.2182058
[3,]  0.36199161 0.6759820</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">20180203</span>)
z &lt;-<span class="st"> </span><span class="kw">rmatrixnorm</span>(<span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">mean=</span><span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">6</span>),<span class="dt">nrow=</span><span class="dv">3</span>),<span class="dt">array =</span> <span class="ot">TRUE</span>)
z[<span class="dv">1</span>, , ]</code></pre></div>
<pre><code>            [,1]      [,2]
[1,]  0.04234611 1.7072872
[2,] -1.05186238 0.2182058
[3,]  0.36199161 0.6759820</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(x)</code></pre></div>
<pre><code>[1] &quot;matrix&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(y)</code></pre></div>
<pre><code>[1] &quot;list&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(z)</code></pre></div>
<pre><code>[1] &quot;array&quot;</code></pre>
<p>Densities are computed in much the same way as for other distributions. The defaults for the mean parameters are 0 and identity for the variance matrices. The <code>log</code> parameter sets whether to return the density on the log scale - by default this is <code>FALSE</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">20180202</span>)
A =<span class="st"> </span><span class="kw">rmatrixnorm</span>(<span class="dt">n=</span><span class="dv">1</span>,<span class="dt">mean=</span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="op">-</span><span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">25</span>,<span class="op">-</span><span class="dv">1000</span>),<span class="dt">nrow=</span><span class="dv">2</span>),
<span class="dt">L=</span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>,.<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">2</span>))
<span class="kw">dmatrixnorm</span>(A,<span class="dt">mean=</span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="op">-</span><span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">25</span>,<span class="op">-</span><span class="dv">1000</span>),<span class="dt">nrow=</span><span class="dv">2</span>),
  <span class="dt">L=</span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>,.<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">2</span>),<span class="dt">log=</span><span class="ot">TRUE</span> )</code></pre></div>
<pre><code>[1] -4.36614</code></pre>
</div>
<div id="parameter-estimation-for-matrix-variate-normal-distributions" class="section level2">
<h2>Parameter estimation for matrix variate normal distributions</h2>
<p>Maximum likelihood estimation is possible for the matrix variate normal distribution (see <span class="citation">Dutilleul (1999)</span> or <span class="citation">Glanz and Carvalho (2013)</span> for details). The pair of variance matrices are only identifiable up to a constant, so this function sets the first element of <span class="math inline">\(\mathbf{U}\)</span> to <span class="math inline">\(1\)</span>.</p>
<p>There are two restrictions possible for the mean matrices: <code>row.mean</code> will force a common mean within a row and <code>col.mean</code> will force a common mean within a column. Restrictions on <span class="math inline">\(\mathbf{U}\)</span> and <span class="math inline">\(\mathbf{V}\)</span> are possible with <code>row.variance</code> and <code>col.variance</code> commands. Currently the only option is to impose an AR(1) structure by providing the <code>AR(1)</code> option. This works by using <code>optim</code> to find the appropriate <span class="math inline">\(\rho\)</span> - it is not fast but if this is the true structure it will be better than an unstructured variance matrix. The <span class="math inline">\(\rho\)</span> parameter shouuld be <span class="math inline">\(&gt;0\)</span> but is not forced to be non-negative.</p>
<p>In order to fit parameters for an <span class="math inline">\(n \times p\)</span> matrix, at least <span class="math inline">\(\max (n/p,p/n) + 1\)</span> observations are needed.</p>
<p>The function expects data in a format produced by the <code>rmatrixnorm</code> function. The results are only the parameter estimates and do not include measures of uncertainty.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">20180202</span>)
A =<span class="st"> </span><span class="kw">rmatrixnorm</span>(<span class="dt">n=</span><span class="dv">100</span>,<span class="dt">mean=</span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="op">-</span><span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">25</span>,<span class="op">-</span><span class="dv">1000</span>),<span class="dt">nrow=</span><span class="dv">2</span>),
   <span class="dt">L=</span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>,.<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">2</span>),<span class="dt">list=</span><span class="ot">TRUE</span>)
results=<span class="kw">mle.matrixnorm</span>(A)
<span class="kw">print</span>(results)</code></pre></div>
<pre><code>$mean
           [,1]         [,2]      [,3]
[1,] 99.7692446 -100.2587675   25.0921
[2,] -0.1010964   -0.1537989 -999.9448

$U
          [,1]      [,2]
[1,] 1.0000000 0.5011833
[2,] 0.5011833 0.2542832

$V
           [,1]       [,2]        [,3]
[1,] 3.98476075  0.3540901  0.01317917
[2,] 0.35409007  3.9535485 -0.19509719
[3,] 0.01317917 -0.1950972  3.22245112

$iter
[1] 7

$tol
[1] 6.580928e-10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results.fixrows =<span class="st"> </span><span class="kw">mle.matrixnorm</span>(A, <span class="dt">row.mean=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>Warning in mle.matrixnorm(A, row.mean = TRUE): Failed to converge</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(results.fixrows)</code></pre></div>
<pre><code>$mean
           [,1]       [,2]       [,3]
[1,]    8.20086    8.20086    8.20086
[2,] -333.39989 -333.39989 -333.39989

$U
          [,1]      [,2]
[1,] 1.0000000 0.4927186
[2,] 0.4927186 0.2454397

$V
          [,1]      [,2]      [,3]
[1,]  15567524  20878147 -36445667
[2,]  20878147  28027167 -48905309
[3,] -36445667 -48905309  85350979

$iter
[1] 100

$tol
[1] 3411.292</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># this failure is expected with misspecification! </span>

B =<span class="st"> </span><span class="kw">rmatrixnorm</span>(<span class="dv">50</span>,<span class="dt">mean=</span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>,<span class="dt">nrow=</span><span class="dv">5</span>),<span class="dt">U=</span><span class="dv">3</span><span class="op">*</span><span class="kw">toeplitz</span>(.<span class="dv">6</span><span class="op">^</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)))
<span class="kw">mle.matrixnorm</span>(B,<span class="dt">row.variance=</span><span class="st">&quot;AR(1)&quot;</span>)</code></pre></div>
<pre><code>Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.</code></pre>
<pre><code>Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.</code></pre>
<pre><code>Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.</code></pre>
<pre><code>Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.</code></pre>
<pre><code>Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.</code></pre>
<pre><code>Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.</code></pre>
<pre><code>Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.</code></pre>
<pre><code>Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.999 high correlation may
cause numerical problems.</code></pre>
<pre><code>Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.

Warning in toepmatrix(dims[2], theta): Rho = 0.998 high correlation may
cause numerical problems.</code></pre>
<pre><code>$mean
          [,1]     [,2]     [,3]
[1,] 0.9879945 5.976905 10.88718
[2,] 1.8732469 6.852212 12.18793
[3,] 2.9224880 7.939933 13.30729
[4,] 4.2194033 9.036333 14.06759
[5,] 5.2340302 9.857787 14.63149

$U
          [,1]      [,2]      [,3]      [,4]      [,5]
[1,] 1.0000000 0.5843139 0.3414228 0.1994981 0.1165695
[2,] 0.5843139 1.0000000 0.5843139 0.3414228 0.1994981
[3,] 0.3414228 0.5843139 1.0000000 0.5843139 0.3414228
[4,] 0.1994981 0.3414228 0.5843139 1.0000000 0.5843139
[5,] 0.1165695 0.1994981 0.3414228 0.5843139 1.0000000

$V
             [,1]         [,2]       [,3]
[1,] 1.8560017484 0.0005009877 0.01055515
[2,] 0.0005009877 1.5764046590 0.06611688
[3,] 0.0105551486 0.0661168803 1.81785108

$iter
[1] 11

$tol
[1] 1.9879e-10</code></pre>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-dutilleul1999mle">
<p>Dutilleul, Pierre. 1999. “The Mle Algorithm for the Matrix Normal Distribution.” <em>Journal of Statistical Computation and Simulation</em> 64 (2). Taylor &amp; Francis: 105–23.</p>
</div>
<div id="ref-2013arXiv1309.6609G">
<p>Glanz, H., and L. Carvalho. 2013. “An Expectation-Maximization Algorithm for the Matrix Normal Distribution.” <em>ArXiv E-Prints</em>, September.</p>
</div>
<div id="ref-gupta1999matrix">
<p>Gupta, Arjun K, and Daya K Nagar. 1999. <em>Matrix Variate Distributions</em>. Vol. 104. CRC Press.</p>
</div>
<div id="ref-Matrix_normal_distribution">
<p>Wikipedia. 2018. “Matrix normal distribution — Wikipedia, the Free Encyclopedia.” <a href="http://en.wikipedia.org/w/index.php?title=Matrix%20normal%20distribution&amp;oldid=757552257">http://en.wikipedia.org/w/index.php?title=Matrix%20normal%20distribution&amp;oldid=757552257</a>.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
